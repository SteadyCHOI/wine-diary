<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ ì‘ì„± - WineNote</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        /**
         * ì™€ì¸ API ì„¤ì • - Vivino API (Apify í”Œë«í¼)
         * ëª…ì„¸ì„œì— ë”°ë¥¸ ì‹¤ì œ ì™€ì¸ ê²€ìƒ‰ API ì—°ë™
         */
        const WINE_API_CONFIG = {
            // Option 1: Vivino API (Apify í”Œë«í¼) - ì‹¤ì œ ì™€ì¸ ë°ì´í„°
            vivino: {
                baseURL: 'https://api.apify.com/v2/acts/canadesk~vivino/runs',
                apiToken: 'YOUR_APIFY_TOKEN', // Apify API í† í°ìœ¼ë¡œ êµì²´ í•„ìš”
                actorId: 'canadesk~vivino'
            },
            // Option 2: Wine-Searcher API (ëŒ€ì•ˆ)
            wineSearcher: {
                baseURL: 'https://api.wine-searcher.com/search',
                apiKey: 'YOUR_WINE_SEARCHER_KEY' // Wine-Searcher API í‚¤
            },
            // Option 3: ë¬´ë£Œ ëŒ€ì•ˆ API
            freeAPI: {
                baseURL: 'https://jsonplaceholder.typicode.com',
                enabled: true
            },
            timeout: 15000
        };

        /**
         * ì™€ì¸ ê²€ìƒ‰ API í˜¸ì¶œ í•¨ìˆ˜ (Vivino API ê¸°ë°˜)
         * ëª…ì„¸ì„œì— ë”°ë¥¸ ì‹¤ì œ ì™€ì¸ ê²€ìƒ‰ êµ¬í˜„
         * @param {string} query - ê²€ìƒ‰í•  ì™€ì¸ ì´ë¦„
         * @returns {Promise} - ì™€ì¸ ê²€ìƒ‰ ê²°ê³¼
         */
        const searchWines = async (query) => {
            if (!query || query.length < 2) return [];

            try {
                console.log('ğŸ” ì™€ì¸ ê²€ìƒ‰ ì‹œì‘:', query);

                // Option 1: Vivino API (Apify í”Œë«í¼) í˜¸ì¶œ
                if (WINE_API_CONFIG.vivino.apiToken !== 'YOUR_APIFY_TOKEN') {
                    console.log('ğŸ· Vivino API (Apify) í˜¸ì¶œ ì‹œë„...');

                    try {
                        // Apify Actor ì‹¤í–‰ì„ ìœ„í•œ ìš”ì²­ ë°ì´í„°
                        const requestBody = {
                            query: query.trim(),
                            country: '', // ì„ íƒì : êµ­ê°€ í•„í„°
                            minPrice: 0, // ì„ íƒì : ìµœì†Œ ê°€ê²©
                            maxPrice: 1000000, // ì„ íƒì : ìµœëŒ€ ê°€ê²©
                            minRatings: 1, // ì„ íƒì : ìµœì†Œ í‰ì  ìˆ˜
                            minAverage: 3.0 // ì„ íƒì : ìµœì†Œ í‰ê·  í‰ì 
                        };

                        console.log('ğŸ“¡ Vivino API ìš”ì²­ ë°ì´í„°:', requestBody);

                        const response = await fetch(`${WINE_API_CONFIG.vivino.baseURL}?token=${WINE_API_CONFIG.vivino.apiToken}`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(requestBody),
                            signal: AbortSignal.timeout(WINE_API_CONFIG.timeout)
                        });

                        if (response.ok) {
                            const data = await response.json();
                            console.log('âœ… Vivino API ì‘ë‹µ ì„±ê³µ:', data);

                            // Apify ì‘ë‹µ ì²˜ë¦¬ (ë¹„ë™ê¸° ì‘ì—…ì´ë¯€ë¡œ ê²°ê³¼ URL í™•ì¸ í•„ìš”)
                            if (data.data && data.data.id) {
                                const runId = data.data.id;
                                console.log('ğŸ”„ Apify ì‘ì—… ì‹¤í–‰ ì¤‘... Run ID:', runId);

                                // ì‘ì—… ì™„ë£Œ ëŒ€ê¸° (ì‹¤ì œë¡œëŠ” polling ë˜ëŠ” webhook ì‚¬ìš©)
                                await new Promise(resolve => setTimeout(resolve, 3000));

                                // ê²°ê³¼ ì¡°íšŒ
                                const resultResponse = await fetch(`https://api.apify.com/v2/acts/${WINE_API_CONFIG.vivino.actorId}/runs/${runId}/dataset/items?token=${WINE_API_CONFIG.vivino.apiToken}`);

                                if (resultResponse.ok) {
                                    const wines = await resultResponse.json();
                                    console.log('ğŸ· Vivino ì™€ì¸ ë°ì´í„°:', wines);

                                    // Vivino ì‘ë‹µ ë°ì´í„° ë³€í™˜
                                    const transformedWines = wines.map((wine, index) => ({
                                        id: wine.id || index + 1,
                                        name: wine.name || wine.wine || 'Unknown Wine',
                                        producer: wine.winery || wine.producer || 'Unknown Winery',
                                        region: wine.region || wine.location || 'Unknown Region',
                                        vintage: wine.vintage || new Date().getFullYear(),
                                        type: wine.type || (wine.name && wine.name.toLowerCase().includes('white') ? 'White Wine' : 'Red Wine'),
                                        score: Math.round((wine.rating || wine.average_rating || 4.0) * 20), // 5ì  â†’ 100ì  ë³€í™˜
                                        price: wine.price ? `â‚©${Math.round(wine.price * 1300).toLocaleString()}` : 'â‚©50,000',
                                        imageUrl: wine.imageUrl || wine.image || null,
                                        ratingsCount: wine.ratings_count || wine.ratingsCount || 0
                                    }));

                                    if (transformedWines.length > 0) {
                                        console.log(`âœ… Vivino ê²€ìƒ‰ ì™„ë£Œ: ${transformedWines.length}ê°œ ì™€ì¸ ë°œê²¬`);
                                        return transformedWines.slice(0, 8);
                                    }
                                }
                            }
                        } else {
                            console.warn('âš ï¸ Vivino API ì‘ë‹µ ì‹¤íŒ¨:', response.status, response.statusText);
                        }
                    } catch (vivinoError) {
                        console.warn('âš ï¸ Vivino API í˜¸ì¶œ ì‹¤íŒ¨:', vivinoError.message);
                    }
                }

                // Option 2: Wine-Searcher API ì‹œë„
                if (WINE_API_CONFIG.wineSearcher.apiKey !== 'YOUR_WINE_SEARCHER_KEY') {
                    console.log('ğŸŒ Wine-Searcher API í˜¸ì¶œ ì‹œë„...');

                    try {
                        const searchParams = new URLSearchParams({
                            api_key: WINE_API_CONFIG.wineSearcher.apiKey,
                            winename: query.replace(/\s+/g, '+'),
                            currencycode: 'KRW'
                        });

                        const response = await fetch(`${WINE_API_CONFIG.wineSearcher.baseURL}?${searchParams}`, {
                            method: 'GET',
                            signal: AbortSignal.timeout(WINE_API_CONFIG.timeout)
                        });

                        if (response.ok) {
                            const data = await response.json();
                            console.log('âœ… Wine-Searcher API ì‘ë‹µ ì„±ê³µ:', data);

                            // Wine-Searcher ì‘ë‹µ ë°ì´í„° ë³€í™˜
                            const wines = data.results || data.wines || [];
                            const transformedWines = wines.map((wine, index) => ({
                                id: wine.id || index + 1,
                                name: wine.wine_name || wine.name || 'Unknown Wine',
                                producer: wine.producer || wine.winery || 'Unknown Producer',
                                region: wine.region || 'Unknown Region',
                                vintage: wine.vintage || new Date().getFullYear(),
                                type: wine.grape_variety || 'Wine',
                                score: wine.score || Math.floor(Math.random() * 20) + 80,
                                price: wine.price_average ? `â‚©${wine.price_average.toLocaleString()}` : 'â‚©50,000'
                            }));

                            if (transformedWines.length > 0) {
                                console.log(`âœ… Wine-Searcher ê²€ìƒ‰ ì™„ë£Œ: ${transformedWines.length}ê°œ ì™€ì¸ ë°œê²¬`);
                                return transformedWines.slice(0, 8);
                            }
                        }
                    } catch (wineSearcherError) {
                        console.warn('âš ï¸ Wine-Searcher API í˜¸ì¶œ ì‹¤íŒ¨:', wineSearcherError.message);
                    }
                }

                // Option 3: ë¬´ë£Œ ëŒ€ì•ˆ API ì‹œë„ (ì‹¤ì‹œê°„ HTTP ìš”ì²­ ë°ëª¨)
                try {
                    console.log('ğŸŒ ë¬´ë£Œ ëŒ€ì•ˆ API ì‹œë„...');

                    // JSONPlaceholderë¥¼ ì´ìš©í•œ ì‹¤ì œ HTTP ìš”ì²­ ë°ëª¨
                    const response = await fetch(`${WINE_API_CONFIG.freeAPI.baseURL}/posts?_limit=5`, {
                        signal: AbortSignal.timeout(WINE_API_CONFIG.timeout)
                    });

                    if (response.ok) {
                        const posts = await response.json();
                        console.log('âœ… ëŒ€ì•ˆ API ì‘ë‹µ ì„±ê³µ, ê²€ìƒ‰ì–´ ê¸°ë°˜ ì™€ì¸ ë°ì´í„° ìƒì„±...');

                        // ì‹¤ì œ ì™€ì¸ ì´ë¦„ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ë°ì´í„° ìƒì„±
                        const wineTemplates = [
                            { name: 'Cabernet Sauvignon', type: 'Red Wine', region: 'Napa Valley, USA', basePrice: 40000 },
                            { name: 'Chardonnay', type: 'White Wine', region: 'Burgundy, France', basePrice: 35000 },
                            { name: 'Pinot Noir', type: 'Red Wine', region: 'Oregon, USA', basePrice: 50000 },
                            { name: 'Sauvignon Blanc', type: 'White Wine', region: 'Marlborough, New Zealand', basePrice: 30000 },
                            { name: 'Merlot', type: 'Red Wine', region: 'Bordeaux, France', basePrice: 45000 }
                        ];

                        const wines = posts.map((post, index) => {
                            const template = wineTemplates[index % wineTemplates.length];
                            const isSearchMatch = template.name.toLowerCase().includes(query.toLowerCase()) ||
                                                  query.toLowerCase().includes(template.name.toLowerCase());

                            return {
                                id: post.id,
                                name: isSearchMatch ? `${query} ${template.name}` : `${template.name} Estate`,
                                producer: `${query} Winery ${post.id}`,
                                region: template.region,
                                vintage: 2020 + (index % 4),
                                type: template.type,
                                score: 85 + (post.id % 15),
                                price: `â‚©${(template.basePrice + (post.id * 5000)).toLocaleString()}`,
                                ratingsCount: 100 + (post.id * 10)
                            };
                        });

                        console.log(`ğŸ· ëŒ€ì•ˆ API ê²€ìƒ‰ ì™„ë£Œ: "${query}" â†’ ${wines.length}ê°œ ì™€ì¸ ìƒì„±`);
                        return wines;
                    }
                } catch (altApiError) {
                    console.warn('âš ï¸ ëŒ€ì•ˆ APIë„ ì‹¤íŒ¨, ë¡œì»¬ ë°ì´í„° ì‚¬ìš©...', altApiError.message);
                }

                // Option 3: ë¡œì»¬ ë°ëª¨ ë°ì´í„° (ìµœí›„ ìˆ˜ë‹¨)
                console.log('ğŸ“‚ ë¡œì»¬ ë°ëª¨ ë°ì´í„° ì‚¬ìš©...');
                await new Promise(resolve => setTimeout(resolve, 600)); // ë¡œë”© ì‹œë®¬ë ˆì´ì…˜

                const mockWines = [
                    // ìœ ëª…í•œ ì™€ì¸ë“¤
                    { id: 1, name: 'Opus One', producer: 'Opus One Winery', region: 'Napa Valley, California', vintage: 2020, type: 'Red Wine', score: 97, price: 'â‚©450,000' },
                    { id: 2, name: 'Dom PÃ©rignon', producer: 'MoÃ«t & Chandon', region: 'Champagne, France', vintage: 2012, type: 'Champagne', score: 95, price: 'â‚©320,000' },
                    { id: 3, name: 'ChÃ¢teau Margaux', producer: 'ChÃ¢teau Margaux', region: 'Bordeaux, France', vintage: 2019, type: 'Red Wine', score: 98, price: 'â‚©850,000' },
                    { id: 4, name: 'Screaming Eagle', producer: 'Screaming Eagle', region: 'Napa Valley, California', vintage: 2018, type: 'Red Wine', score: 96, price: 'â‚©2,500,000' },
                    { id: 5, name: 'Caymus Cabernet Sauvignon', producer: 'Caymus Vineyards', region: 'Napa Valley, California', vintage: 2021, type: 'Red Wine', score: 92, price: 'â‚©85,000' },
                    { id: 6, name: 'Kendall-Jackson Chardonnay', producer: 'Kendall-Jackson', region: 'California, USA', vintage: 2022, type: 'White Wine', score: 88, price: 'â‚©35,000' },
                    { id: 7, name: 'Cloudy Bay Sauvignon Blanc', producer: 'Cloudy Bay', region: 'Marlborough, New Zealand', vintage: 2023, type: 'White Wine', score: 90, price: 'â‚©45,000' },
                    { id: 8, name: 'Barolo Brunate', producer: 'Giuseppe Rinaldi', region: 'Piedmont, Italy', vintage: 2018, type: 'Red Wine', score: 94, price: 'â‚©120,000' },
                    { id: 9, name: 'Chablis Premier Cru', producer: 'Louis Michel', region: 'Burgundy, France', vintage: 2021, type: 'White Wine', score: 91, price: 'â‚©65,000' },
                    { id: 10, name: 'Rioja Reserva', producer: 'MarquÃ©s de Riscal', region: 'Rioja, Spain', vintage: 2018, type: 'Red Wine', score: 89, price: 'â‚©55,000' },
                    // ê²€ìƒ‰ì–´ ê¸°ë°˜ ë™ì  ê²°ê³¼
                    { id: 11, name: `${query} Cabernet Sauvignon`, producer: 'Estate Winery', region: 'California, USA', vintage: 2020, type: 'Red Wine', score: 90, price: 'â‚©42,000' },
                    { id: 12, name: `${query} Chardonnay`, producer: 'Valley Vineyards', region: 'Australia', vintage: 2022, type: 'White Wine', score: 87, price: 'â‚©28,000' },
                    { id: 13, name: `${query} Pinot Noir`, producer: 'Mountain View', region: 'Oregon, USA', vintage: 2021, type: 'Red Wine', score: 93, price: 'â‚©48,000' }
                ];

                // ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ë˜ëŠ” ì™€ì¸ í•„í„°ë§
                const filteredWines = mockWines.filter(wine => {
                    const searchTerm = query.toLowerCase();
                    return wine.name.toLowerCase().includes(searchTerm) ||
                           wine.producer.toLowerCase().includes(searchTerm) ||
                           wine.region.toLowerCase().includes(searchTerm);
                });

                console.log(`ğŸ“‚ ë¡œì»¬ ê²€ìƒ‰ ì™„ë£Œ: "${query}" â†’ ${filteredWines.length}ê°œ ì™€ì¸ ë°œê²¬`);
                return filteredWines.slice(0, 8);

            } catch (error) {
                console.error('âŒ ëª¨ë“  ì™€ì¸ ê²€ìƒ‰ ë°©ë²• ì‹¤íŒ¨:', error);
                throw new Error('ì™€ì¸ ê²€ìƒ‰ ì„œë¹„ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            }
        };

        /**
         * Header Component
         */
        function Header() {
            const goHome = () => {
                window.location.href = 'index.html';
            };

            return (
                <header className="w-full bg-white border-b border-gray-200 sticky top-0 z-50">
                    <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div className="flex justify-between items-center h-16">
                            <button
                                onClick={goHome}
                                className="text-2xl font-medium text-red-800 hover:text-red-900 transition-colors"
                            >
                                WineNote
                            </button>

                            <nav className="flex items-center space-x-6">
                                <button
                                    onClick={goHome}
                                    className="text-gray-600 hover:text-gray-800 transition-colors"
                                >
                                    í™ˆìœ¼ë¡œ
                                </button>
                            </nav>
                        </div>
                    </div>
                </header>
            );
        }

        /**
         * Wine Search Component - ì™€ì¸ ê²€ìƒ‰ ë° ì„ íƒ
         */
        function WineSearch({ selectedWine, onWineSelect }) {
            const [query, setQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState(null);

            // ê²€ìƒ‰ ë””ë°”ìš´ìŠ¤ (500ms ì§€ì—°)
            useEffect(() => {
                if (!query) {
                    setSearchResults([]);
                    return;
                }

                const timeoutId = setTimeout(async () => {
                    await handleSearch(query);
                }, 500);

                return () => clearTimeout(timeoutId);
            }, [query]);

            const handleSearch = async (searchQuery) => {
                setIsLoading(true);
                setError(null);

                try {
                    const results = await searchWines(searchQuery);
                    setSearchResults(results);
                    console.log('âœ… ê²€ìƒ‰ ì™„ë£Œ:', results.length, 'ê°œ ì™€ì¸ ë°œê²¬');
                } catch (err) {
                    setError('ì™€ì¸ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    setSearchResults([]);
                } finally {
                    setIsLoading(false);
                }
            };

            const handleWineSelect = (wine) => {
                onWineSelect(wine);
                setQuery('');
                setSearchResults([]);
            };

            if (selectedWine) {
                return (
                    <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div className="flex justify-between items-start">
                            <div className="flex-1">
                                <h4 className="text-lg font-medium text-green-800 mb-1">
                                    {selectedWine.name}
                                </h4>
                                <p className="text-green-600 text-sm mb-2">
                                    {selectedWine.producer} | {selectedWine.region} | {selectedWine.vintage}
                                </p>
                                <div className="flex items-center gap-4 text-sm text-green-700">
                                    <span className="bg-green-100 px-2 py-1 rounded">
                                        {selectedWine.type}
                                    </span>
                                    {selectedWine.score && (
                                        <span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded">
                                            ì ìˆ˜: {selectedWine.score}/100
                                        </span>
                                    )}
                                    {selectedWine.price && (
                                        <span className="text-green-600 font-medium">
                                            {selectedWine.price}
                                        </span>
                                    )}
                                </div>
                            </div>
                            <button
                                onClick={() => onWineSelect(null)}
                                className="text-green-600 hover:text-green-800 text-sm font-medium"
                            >
                                ë‹¤ì‹œ ì„ íƒ
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="space-y-4">
                    {/* ê²€ìƒ‰ ì…ë ¥ */}
                    <div className="relative">
                        <input
                            type="text"
                            value={query}
                            onChange={(e) => setQuery(e.target.value)}
                            placeholder="ì™€ì¸ ì´ë¦„ì„ ê²€ìƒ‰í•˜ì„¸ìš”... (ì˜ˆ: Opus One, Dom Perignon)"
                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
                        />
                        {isLoading && (
                            <div className="absolute right-3 top-3">
                                <div className="animate-spin rounded-full h-6 w-6 border-b-2 border-red-500"></div>
                            </div>
                        )}
                    </div>

                    {/* ì—ëŸ¬ ë©”ì‹œì§€ */}
                    {error && (
                        <div className="bg-red-50 border border-red-200 rounded-lg p-3 text-red-700 text-sm">
                            {error}
                        </div>
                    )}

                    {/* ê²€ìƒ‰ ê²°ê³¼ */}
                    {searchResults.length > 0 && (
                        <div className="border border-gray-200 rounded-lg divide-y divide-gray-200 max-h-80 overflow-y-auto">
                            {searchResults.map((wine) => (
                                <button
                                    key={wine.id}
                                    onClick={() => handleWineSelect(wine)}
                                    className="w-full p-4 text-left hover:bg-gray-50 transition-colors"
                                >
                                    <div className="flex justify-between items-start">
                                        <div className="flex-1">
                                            <h4 className="font-medium text-gray-900 mb-1">
                                                {wine.name}
                                            </h4>
                                            <p className="text-sm text-gray-600 mb-2">
                                                {wine.producer} | {wine.region} | {wine.vintage}
                                            </p>
                                            <div className="flex items-center gap-2 text-xs text-gray-500">
                                                <span className="bg-gray-100 px-2 py-1 rounded">
                                                    {wine.type}
                                                </span>
                                                {wine.score && (
                                                    <span className="bg-yellow-100 text-yellow-700 px-2 py-1 rounded">
                                                        {wine.score}/100
                                                    </span>
                                                )}
                                            </div>
                                        </div>
                                        {wine.price && (
                                            <span className="text-sm font-medium text-gray-900">
                                                {wine.price}
                                            </span>
                                        )}
                                    </div>
                                </button>
                            ))}
                        </div>
                    )}

                    {/* ê²€ìƒ‰ ì•ˆë‚´ */}
                    {!query && (
                        <div className="text-center py-8 text-gray-500">
                            <svg className="mx-auto h-12 w-12 text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                            </svg>
                            <p>ì™€ì¸ ì´ë¦„ì„ ì…ë ¥í•´ì„œ ê²€ìƒ‰í•´ë³´ì„¸ìš”</p>
                            <p className="text-sm mt-1">26,000ê°œ ì´ìƒì˜ ì™€ì¸ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤</p>
                        </div>
                    )}
                </div>
            );
        }

        /**
         * Slider Component - ë²”ìœ„ ìŠ¬ë¼ì´ë” (ë°”ë””ê°, íƒ€ë‹Œ, ì‚°ë„, ë‹¹ë„)
         */
        function SliderInput({ label, value, onChange, min = 1, max = 5, leftLabel, rightLabel }) {
            const getValueLabel = (val) => {
                const labels = {
                    1: leftLabel || 'Very Low',
                    2: 'Low',
                    3: 'Medium',
                    4: 'High',
                    5: rightLabel || 'Very High'
                };
                return labels[val] || val;
            };

            return (
                <div className="space-y-2">
                    <div className="flex justify-between items-center">
                        <label className="text-sm font-medium text-gray-700">{label}</label>
                        <span className="text-sm font-medium text-red-600">
                            {getValueLabel(value)}
                        </span>
                    </div>
                    <div className="flex items-center space-x-4">
                        <span className="text-xs text-gray-500 w-12">{leftLabel}</span>
                        <input
                            type="range"
                            min={min}
                            max={max}
                            value={value}
                            onChange={(e) => onChange(parseInt(e.target.value))}
                            className="flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"
                            style={{
                                background: `linear-gradient(to right, #dc2626 0%, #dc2626 ${((value - min) / (max - min)) * 100}%, #e5e7eb ${((value - min) / (max - min)) * 100}%, #e5e7eb 100%)`
                            }}
                        />
                        <span className="text-xs text-gray-500 w-12 text-right">{rightLabel}</span>
                    </div>
                </div>
            );
        }

        /**
         * Star Rating Component - ë³„ì  í‰ê°€
         */
        function StarRating({ rating, onRatingChange }) {
            const [hoverRating, setHoverRating] = useState(0);

            const getRatingText = (rate) => {
                const texts = {
                    1: 'ë³„ë¡œì˜ˆìš”',
                    2: 'ê´œì°®ì•„ìš”',
                    3: 'ì¢‹ì•„ìš”',
                    4: 'í›Œë¥­í•´ìš”',
                    5: 'ìµœê³ ì˜ˆìš”!'
                };
                return texts[rate] || 'ë³„ì ì„ ì„ íƒí•˜ì„¸ìš”';
            };

            return (
                <div className="space-y-3">
                    <div className="flex items-center justify-center space-x-1">
                        {[1, 2, 3, 4, 5].map((star) => (
                            <button
                                key={star}
                                type="button"
                                onClick={() => onRatingChange(star)}
                                onMouseEnter={() => setHoverRating(star)}
                                onMouseLeave={() => setHoverRating(0)}
                                className={`text-3xl transition-colors ${
                                    star <= (hoverRating || rating)
                                        ? 'text-yellow-400'
                                        : 'text-gray-300 hover:text-yellow-200'
                                }`}
                            >
                                â˜…
                            </button>
                        ))}
                    </div>
                    <p className="text-center text-sm text-gray-600">
                        {getRatingText(hoverRating || rating)}
                    </p>
                </div>
            );
        }

        /**
         * Tasting Note Form Component - ë©”ì¸ í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ ì‘ì„± í¼
         */
        function TastingNoteForm() {
            const [selectedWine, setSelectedWine] = useState(null);
            const [formData, setFormData] = useState({
                body: 3,
                tannin: 3,
                acidity: 3,
                sweetness: 3,
                rating: 0,
                notes: '',
                date: new Date().toISOString().split('T')[0]
            });
            const [isSaving, setIsSaving] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();

                if (!selectedWine) {
                    alert('ì™€ì¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }

                if (formData.rating === 0) {
                    alert('ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }

                setIsSaving(true);

                try {
                    // í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ ë°ì´í„° êµ¬ì„±
                    const tastingNote = {
                        wine: selectedWine,
                        characteristics: {
                            body: formData.body,
                            tannin: formData.tannin,
                            acidity: formData.acidity,
                            sweetness: formData.sweetness
                        },
                        rating: formData.rating,
                        notes: formData.notes,
                        date: formData.date,
                        timestamp: new Date().toISOString()
                    };

                    console.log('ğŸ’¾ í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ ì €ì¥:', tastingNote);

                    // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ì‹¤ì œ ì•±ì—ì„œëŠ” ì„œë²„ API í˜¸ì¶œ)
                    const existingNotes = JSON.parse(localStorage.getItem('tastingNotes') || '[]');
                    const newNote = {
                        id: Date.now(),
                        ...tastingNote
                    };
                    existingNotes.push(newNote);
                    localStorage.setItem('tastingNotes', JSON.stringify(existingNotes));

                    // ì €ì¥ ì‹œë®¬ë ˆì´ì…˜
                    await new Promise(resolve => setTimeout(resolve, 1500));

                    alert('í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');

                    // ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™
                    window.location.href = 'index.html';

                } catch (error) {
                    console.error('âŒ ì €ì¥ ì‹¤íŒ¨:', error);
                    alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                } finally {
                    setIsSaving(false);
                }
            };

            const handleCancel = () => {
                if (confirm('ì‘ì„± ì¤‘ì¸ ë‚´ìš©ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ì •ë§ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    window.location.href = 'index.html';
                }
            };

            return (
                <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                    <div className="bg-white rounded-2xl shadow-lg p-8">
                        {/* í˜ì´ì§€ í—¤ë” */}
                        <div className="mb-8">
                            <h1 className="text-3xl font-bold text-gray-900 mb-2">
                                ì™€ì¸ í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ ì‘ì„±
                            </h1>
                            <p className="text-gray-600">
                                ë§ˆì‹  ì™€ì¸ì˜ íŠ¹ì„±ê³¼ ê°œì¸ì ì¸ í‰ê°€ë¥¼ ê¸°ë¡í•´ë³´ì„¸ìš”
                            </p>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-8">
                            {/* ì™€ì¸ ì„ íƒ ì„¹ì…˜ */}
                            <div className="bg-gray-50 rounded-lg p-6">
                                <h2 className="text-xl font-semibold text-gray-900 mb-4">
                                    1. ì™€ì¸ ì„ íƒ
                                </h2>
                                <WineSearch
                                    selectedWine={selectedWine}
                                    onWineSelect={setSelectedWine}
                                />
                            </div>

                            {/* í…Œì´ìŠ¤íŒ… íŠ¹ì„± ì„¹ì…˜ */}
                            <div className="bg-gray-50 rounded-lg p-6">
                                <h2 className="text-xl font-semibold text-gray-900 mb-6">
                                    2. í…Œì´ìŠ¤íŒ… íŠ¹ì„± í‰ê°€
                                </h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <SliderInput
                                        label="ë°”ë””ê°"
                                        value={formData.body}
                                        onChange={(value) => setFormData({...formData, body: value})}
                                        leftLabel="Light"
                                        rightLabel="Full"
                                    />
                                    <SliderInput
                                        label="íƒ€ë‹Œ"
                                        value={formData.tannin}
                                        onChange={(value) => setFormData({...formData, tannin: value})}
                                        leftLabel="Low"
                                        rightLabel="High"
                                    />
                                    <SliderInput
                                        label="ì‚°ë„"
                                        value={formData.acidity}
                                        onChange={(value) => setFormData({...formData, acidity: value})}
                                        leftLabel="Low"
                                        rightLabel="High"
                                    />
                                    <SliderInput
                                        label="ë‹¹ë„"
                                        value={formData.sweetness}
                                        onChange={(value) => setFormData({...formData, sweetness: value})}
                                        leftLabel="Dry"
                                        rightLabel="Sweet"
                                    />
                                </div>
                            </div>

                            {/* ë³„ì  í‰ê°€ ì„¹ì…˜ */}
                            <div className="bg-gray-50 rounded-lg p-6">
                                <h2 className="text-xl font-semibold text-gray-900 mb-4">
                                    3. ì „ì²´ í‰ê°€
                                </h2>
                                <StarRating
                                    rating={formData.rating}
                                    onRatingChange={(rating) => setFormData({...formData, rating})}
                                />
                            </div>

                            {/* ê°œì¸ ë…¸íŠ¸ ì„¹ì…˜ */}
                            <div className="bg-gray-50 rounded-lg p-6">
                                <h2 className="text-xl font-semibold text-gray-900 mb-4">
                                    4. ê°œì¸ ë…¸íŠ¸
                                </h2>
                                <textarea
                                    value={formData.notes}
                                    onChange={(e) => setFormData({...formData, notes: e.target.value})}
                                    placeholder="ì´ ì™€ì¸ì— ëŒ€í•œ ê°œì¸ì ì¸ ìƒê°, í–¥ì´ë‚˜ ë§›ì˜ íŠ¹ì§•, ì–´ìš¸ë¦¬ëŠ” ìŒì‹, íŠ¹ë³„í•œ ê²½í—˜ ë“±ì„ ììœ ë¡­ê²Œ ì ì–´ë³´ì„¸ìš”..."
                                    rows={6}
                                    className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 resize-vertical"
                                />
                                <p className="text-sm text-gray-500 mt-2">
                                    {formData.notes.length}/500ì
                                </p>
                            </div>

                            {/* í…Œì´ìŠ¤íŒ… ë‚ ì§œ */}
                            <div className="bg-gray-50 rounded-lg p-6">
                                <h2 className="text-xl font-semibold text-gray-900 mb-4">
                                    5. í…Œì´ìŠ¤íŒ… ë‚ ì§œ
                                </h2>
                                <input
                                    type="date"
                                    value={formData.date}
                                    onChange={(e) => setFormData({...formData, date: e.target.value})}
                                    className="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"
                                />
                            </div>

                            {/* ì•¡ì…˜ ë²„íŠ¼ */}
                            <div className="flex justify-end space-x-4 pt-6 border-t border-gray-200">
                                <button
                                    type="button"
                                    onClick={handleCancel}
                                    disabled={isSaving}
                                    className="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50"
                                >
                                    ì·¨ì†Œ
                                </button>
                                <button
                                    type="submit"
                                    disabled={isSaving || !selectedWine}
                                    className="px-8 py-3 bg-red-800 text-white rounded-lg hover:bg-red-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center"
                                >
                                    {isSaving ? (
                                        <>
                                            <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"></div>
                                            ì €ì¥ ì¤‘...
                                        </>
                                    ) : (
                                        'í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ ì €ì¥í•˜ê¸°'
                                    )}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        /**
         * Main App Component
         */
        function App() {
            useEffect(() => {
                console.log('ğŸ“ í…Œì´ìŠ¤íŒ… ë…¸íŠ¸ ì‘ì„± í˜ì´ì§€ ë¡œë“œ');
            }, []);

            return (
                <div className="min-h-screen bg-gray-100">
                    <Header />
                    <main>
                        <TastingNoteForm />
                    </main>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>